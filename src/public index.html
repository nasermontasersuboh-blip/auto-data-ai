<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>auto-data-ai – Invoice Extractor</title>
  <style>
    :root { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    body { margin: 0; padding: 24px; background: #0b1020; color: #eef2ff; }
    .wrap { max-width: 840px; margin: 0 auto; }
    h1 { margin: 0 0 8px; font-size: 28px; }
    p.muted { color: #9fb0ff; margin: 0 0 24px; }
    .card { background: #111a2f; border: 1px solid #1e2a4a; border-radius: 14px; padding: 18px; }
    .row { display: grid; gap: 14px; grid-template-columns: 1fr auto; align-items: end; }
    input[type="file"] { padding: 10px; border: 1px dashed #33437a; border-radius: 12px; background:#0d1530; }
    button { padding: 10px 16px; border: 0; border-radius: 10px; background: #5b7cff; color: white; font-weight: 600; cursor: pointer; }
    button[disabled] { opacity: .5; cursor: not-allowed; }
    .out { margin-top: 18px; background: #0d1530; border: 1px solid #1e2a4a; border-radius: 12px; padding: 14px; }
    pre { margin: 0; white-space: pre-wrap; word-break: break-word; }
    .ok { color: #6ee7a8; font-weight: 600; }
    .err { color: #ff8b8b; font-weight: 600; }
    footer { margin-top: 24px; color: #9fb0ff; font-size: 12px; }
    a { color: #99b3ff; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>auto-data-ai – Invoice Extractor</h1>
    <p class="muted">Upload a PDF invoice. The server will extract vendor, date, total, currency and return the raw text snippet.</p>

    <div class="card">
      <div class="row">
        <input id="file" type="file" accept="application/pdf" />
        <button id="btn">Extract</button>
      </div>

      <div class="out" id="status">Ready.</div>
      <div class="out"><pre id="result">—</pre></div>
    </div>

    <footer>
      API docs: <a href="/docs" target="_blank" rel="noreferrer">/docs</a> · Health: <a href="/health" target="_blank" rel="noreferrer">/health</a>
    </footer>
  </div>

  <script>
    const $file = document.getElementById('file');
    const $btn = document.getElementById('btn');
    const $status = document.getElementById('status');
    const $result = document.getElementById('result');

    async function extract() {
      if (!$file.files.length) {
        $status.innerHTML = '<span class="err">Choose a PDF first.</span>';
        return;
      }
      $btn.disabled = true;
      $status.textContent = 'Uploading…';
      $result.textContent = '—';

      try {
        const fd = new FormData();
        fd.append('file', $file.files[0]);

        const res = await fetch('/extract', {
          method: 'POST',
          body: fd
        });

        if (!res.ok) {
          const txt = await res.text().catch(()=>'');
          throw new Error(`HTTP ${res.status} ${res.statusText}\n${txt}`);
        }

        const data = await res.json();
        $status.innerHTML = '<span class="ok">Success.</span>';
        $result.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        $status.innerHTML = '<span class="err">Failed.</span>';
        $result.textContent = String(err?.stack || err);
      } finally {
        $btn.disabled = false;
      }
    }

    $btn.addEventListener('click', extract);
  </script>
</body>
</html>
